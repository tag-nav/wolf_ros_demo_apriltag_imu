config:

  debug:
    profiling: true
    profiling_file: "~/wolf_demo_apriltag_profiling.txt"
    print_problem: true
    print_depth: 4             # only if print_problem
    print_state: true         # only if print_problem
    print_constr_by: true     # only if print_problem
    print_metric: true        # only if print_problem
    print_state_blocks: true  # only if print_problem
    print_period: 1            # only if print_problem
   
  problem:
    node_rate: 200
    follow: "tree_manager.yaml"
    frame_structure: "POV"
    dimension: 3
    prior:
      mode: "initial_guess"
      $state:
        P: [0,0,0.2]
        O: [0.5, -0.5, 0.5, -0.5]  #Â arbitrary
        V: [0,0,0]
      $sigma:
       P: [0.00001, 0.00001, 0.00001]
       O: [3, 3, 3]
       V: [0.1, 0.1, 0.1]
      time_tolerance: 0.005
      
  solver:
    follow: "solver.yaml"

  sensors:
    -
      type: "SensorCamera"
      name: "CAMERA"
      plugin: "vision"
      extrinsic:
        pose: [-0.006, 0.005, 0.012,  0,0,0,1]  # D435i left infra
        # pose: [-0.00722495000,  0.00210141000,  0.0198486200, -0.00279745680, 0.000290441225,  0.000725690561,  0.999995782]  # D435i left infra, calib1
        # pose: [-0.00625492000, -0.000326490000,  0.0202450200, -0.00210374370, 0.000480123914,  0.00111190327,  0.999997055]  # D435i left infra, calib2
        # pose: [0.6, -0.005, -0.012,  0,0,0,1]  # FAKE
        # pose: [0,0,0,  0,0,0,1]
      using_raw: true
      follow: "camera_d435i.yaml"
    -
      type: "SensorImu"
      name: "IMU"
      plugin: "imu"
      extrinsic:
        pose:  [0,0,0, 0,0,0,1]
      follow: "imu_d435i.yaml"
    - 
      type: "SensorPose"
      name: "sensor Pose"
      plugin: "core"
      extrinsic:
        pose: [0,0,0, 0,0,0,1]
      std_px: 100
      std_py: 100
      std_pz: 0.001
      std_ox: 10
      std_oy: 10
      std_oz: 10

  processors:
    -
      type: "ProcessorTrackerLandmarkApriltag"
      name: "APRILTAG PROC"
      sensor_name: "CAMERA"
      plugin: "apriltag"
      follow: "processor_tracker_landmark_apriltag.yaml"
    -
      type: "ProcessorImu"
      name: "IMU PROC"
      sensor_name: "IMU"
      plugin: "imu"
      follow: "processor_imu.yaml"

    - 
      type: "ProcessorPose"
      name: "prc Pose"
      plugin: "core"
      sensor_name: "sensor Pose"
      time_tolerance: 0.01
      keyframe_vote:
        voting_active:    false
      apply_loss_function: false

  # map:
  #   - type: "MapBase"
  #   - plugin: "core"
  #   - filename: "/home/mfourmy/catkin_ws/src/wolf_demo_apriltag_imu/yaml/poster_map_full.yaml"

  ROS subscriber:
    -
      package: "wolf_ros_vision"
      type: "SubscriberCamera"
      topic: "/camera/infra1/image_rect_raw"
      sensor_name: "CAMERA"
    -
      package: "wolf_ros_imu"
      type: "SubscriberImu"
      topic: "/camera/imu"
      sensor_name: "IMU"
      cov_source: "sensor"
      in_degrees: false
    # -
    #   package: "wolf_ros_node"
    #   type: "SubscriberPose"
    #   topic: "/pose_altitude"
    #   sensor_name: "sensor Pose"

  ROS publisher:
    -
      type: "PublisherGraph"
      topic: "graph"
      package: "wolf_ros_node"
      period: 0.1
      viz_scale: 0.3
      text_scale: 0.1
      landmark_text_z_offset: 0.3
      landmark_length: 0.5
      frame_width: 0.01
      frame_length: 0.1
      frame_vel_scale: 1.0
    -
      type: "PublisherTf"
      topic: " "
      package: "wolf_ros_node"
      period: 0.1
      map_frame_id: "map"
      odom_frame_id: "odom"
      base_frame_id: "base_footprint"
      publish_odom_tf: true
    -
      type: "PublisherApriltagDebug"
      processor_name: "APRILTAG PROC"
      topic: "apriltag_detections"
      package: "wolf_ros_apriltag"
      period: 0.1
    -
      type: "PublisherApriltagClusterPose"
      processor_name: "APRILTAG PROC"
      topic: "cluster_pose"
      package: "wolf_ros_apriltag"
      period: 0.1
      follow: "poster_left_apriltags.yaml"
    -
      type: "PublisherPose"
      topic: "current_pose"
      package: "wolf_ros_node"
      period: 0.01
      extrinsics: false
      frame_id: "map"
